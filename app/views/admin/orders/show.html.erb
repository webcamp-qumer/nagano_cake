<div class="title">
<h1>注文履歴詳細</h1>
</div>

<p>購入者<%= @order.customer.name %></p>
<p>注文日<%= @order.created_at %></p>
<p>配送先
   <%= @order.postcode%><%= @order.address %>
   <%= @order.name %>
</p>
<p>支払い方法
</p>
<p>注文ステータス
   <% form_with model:@order, url:admin_order_path do |f| %>
   <%= f.select :status, options_for_select_from_enum(Rating, :status) %>
   <!--select=プルダウンメニューの表示-->
   <%= f.submit '更新'%>
   <% end %>
</p>

<div>
  <table>
  <thead>
    <tr>
      <th>商品名</th>
      <th>単価（税込）</th>
      <th>数量</th>
      <th>小計</th>
      <th>製作ステータス</th>
    </tr>
  </thead>
  
  <tobody> 
    <% @order_histories.each do |order_history| %>
    <td><%= order_history.item.name %></td>
    <td><%= order_history.price %></td>
    <td><%= order_history.quantity %></td>
    <td><%= order_history.price*order_history.quantity %></td>
        <% @total = @total + order_history.price*order_history.quantity %>
        <!--左の@totalは変数-->
    <% end %>

    <td>
        <% form_with model:@order_history, url:admin_order_history_path(order_history) do |f| %>
        <%= f.select :status, options_for_select_from_enum(Rating, :status) %>
        <!--select=プルダウンメニューの表示-->
        <%= f.submit '更新'%>
       <% end %>
    </td>
  </tobody>
  </table>
</div>

<div>
  <p>
    <string>商品合計</string>
    <%= @total.to_s(:delimited) %>円
  </p>
  <p>
  　<string>送料</string>
  　<%= @order.postage.to_s(:delimited) %>円
  </p>
  <p>
  <string>請求合計金額</string>
    <%= @order.total_price.to_s(:delimited) %>円
  </p>
</div>